<Window x:Class="KPFF.AutoCAD.DraftingAssistant.UI.Dialogs.ProjectConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Project Settings"
        Height="700"
        Width="800"
        WindowStartupLocation="CenterOwner"
        Background="#2E3440">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Themes/DarkTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   Text="Project Settings" 
                   Style="{StaticResource DarkTextBlockStyle}"
                   FontSize="16" 
                   FontWeight="Bold" 
                   Margin="0,0,0,20"/>
        
        <!-- Tab Control -->
        <TabControl Grid.Row="1" Background="{StaticResource DarkBackgroundBrush}" Margin="0,0,0,20">
            
            <!-- General Tab -->
            <TabItem Header="General" Style="{StaticResource DarkTabItemStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        
                        <!-- Project Information -->
                        <GroupBox Header="Project Information" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Project Name:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" Name="ProjectNameTextBox" Style="{StaticResource DarkTextBoxStyle}"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Client Name:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBox Grid.Row="1" Grid.Column="1" Name="ClientNameTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,10,0,0"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- File Paths -->
                        <GroupBox Header="File Paths" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                
                                <!-- Excel Index File -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Excel Index File:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="ExcelFilePathTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseExcelButton" Content="Browse..." Width="80" Height="25" Style="{StaticResource DarkButtonStyle}" Click="BrowseExcelButton_Click"/>
                                </Grid>
                                
                                <!-- DWG Files Path -->
                                <Grid Margin="0,10,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="DWG Files Path:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="DwgFilePathTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseDwgButton" Content="Browse..." Width="80" Height="25" Style="{StaticResource DarkButtonStyle}" Click="BrowseDwgButton_Click"/>
                                </Grid>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Excel Index Tables -->
                        <GroupBox Header="Excel Index Tables" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Tables in Excel need to be named by selecting the table, going to the Table Design tab, and naming the table in the Properties section." Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,15" TextWrapping="Wrap"/>
                                <TextBlock Text="The system expects the following tables in the Excel index file:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,15" FontWeight="SemiBold"/>
                                
                                <!-- SHEET_INDEX Table -->
                                <Border BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="1" CornerRadius="3" Background="{StaticResource DarkSurfaceBrush}" Margin="0,0,0,10">
                                    <StackPanel Margin="10">
                                        <TextBlock Text="&quot;SHEET_INDEX&quot;: List of all sheets and metadata, including containing file name and title block attributes." Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" FontWeight="SemiBold" Margin="0,0,0,5" TextWrapping="Wrap"/>
                                        <TextBlock Text="Required:" Style="{StaticResource DarkTextBlockStyle}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <TextBlock Text="• &quot;Sheet&quot; column containing the name of each sheet layout" Style="{StaticResource DarkTextBlockStyle}" Margin="15,0,0,3"/>
                                        <TextBlock Text="• &quot;File&quot; column containing the name of the file that contains each sheet, e.g. &quot;PV-100&quot; (do not include file path or file type extension)" Style="{StaticResource DarkTextBlockStyle}" Margin="15,0,0,3" TextWrapping="Wrap"/>
                                        <TextBlock Text="• Title block attribute columns where the column header corresponds to the attribute definition tag (e.g. for a SHEET_NUMBER tag, the column header can be &quot;Sheet Number&quot;)" Style="{StaticResource DarkTextBlockStyle}" Margin="15,0,0,0" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                                
                                <!-- {SERIES}_NOTES Tables -->
                                <Border BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="1" CornerRadius="3" Background="{StaticResource DarkSurfaceBrush}" Margin="0,0,0,10">
                                    <StackPanel Margin="10">
                                        <TextBlock Text="&quot;{SERIES}_NOTES&quot;, e.g. &quot;PV_NOTES&quot;, &quot;UT_NOTES&quot;, etc: List of all construction notes for each drawing series." Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" FontWeight="SemiBold" Margin="0,0,0,5" TextWrapping="Wrap"/>
                                        <TextBlock Text="Required:" Style="{StaticResource DarkTextBlockStyle}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <TextBlock Text="• &quot;Number&quot; column listing construction note numbers 1-X" Style="{StaticResource DarkTextBlockStyle}" Margin="15,0,0,3"/>
                                        <TextBlock Text="• &quot;Note&quot; column listing corresponding construction notes" Style="{StaticResource DarkTextBlockStyle}" Margin="15,0,0,0"/>
                                    </StackPanel>
                                </Border>
                                
                                <!-- EXCEL_NOTES Table -->
                                <Border BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="1" CornerRadius="3" Background="{StaticResource DarkSurfaceBrush}">
                                    <StackPanel Margin="10">
                                        <TextBlock Text="&quot;EXCEL_NOTES&quot;: Optional, to specify construction notes manually." Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" FontWeight="SemiBold" Margin="0,0,0,5" TextWrapping="Wrap"/>
                                        <TextBlock Text="If included, Required:" Style="{StaticResource DarkTextBlockStyle}" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                        <TextBlock Text="• &quot;Sheet&quot; column containing name of each sheet layout" Style="{StaticResource DarkTextBlockStyle}" Margin="15,0,0,3"/>
                                        <TextBlock Text="• Note columns labeled &quot;Note 1&quot;, &quot;Note 2&quot;, ...: Specified construction note numbers for each sheet" Style="{StaticResource DarkTextBlockStyle}" Margin="15,0,0,0" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Sheet Naming -->
                        <GroupBox Header="Supported Sheet Naming Patterns" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="The system parses sheet names by separating the series from the number parts. The series part determines which {SERIES}_NOTES table to use for construction notes." Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,15" TextWrapping="Wrap"/>
                                
                                <!-- Series Length Setting -->
                                <GroupBox Header="Series Length Configuration" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                                    <StackPanel Margin="10">
                                        <TextBlock Text="Configure how the system determines the series part of sheet names:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10" TextWrapping="Wrap"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Series Detection:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                            <ComboBox Grid.Row="0" Grid.Column="1" Name="SeriesDetectionComboBox" 
                                                      SelectionChanged="SeriesDetectionComboBox_SelectionChanged">
                                                <ComboBoxItem Content="Auto Detect" Tag="0"/>
                                                <ComboBoxItem Content="Manual (1 character)" Tag="1"/>
                                                <ComboBoxItem Content="Manual (2 characters)" Tag="2"/>
                                                <ComboBoxItem Content="Manual (3 characters)" Tag="3"/>
                                                <ComboBoxItem Content="Manual (4 characters)" Tag="4"/>
                                                <ComboBoxItem Content="Manual (5 characters)" Tag="5"/>
                                                <ComboBoxItem Content="Manual (6 characters)" Tag="6"/>
                                                <ComboBoxItem Content="Manual (7 characters)" Tag="7"/>
                                                <ComboBoxItem Content="Manual (8 characters)" Tag="8"/>
                                            </ComboBox>
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Preview:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Top" Margin="0,10,0,0"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Name="SeriesPreviewTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" FontSize="11" 
                                                      Text="ABC-123 → Series: ABC, Number: 123" Margin="0,10,0,0" TextWrapping="Wrap"/>
                                        </Grid>
                                    </StackPanel>
                                </GroupBox>
                                
                            </StackPanel>
                        </GroupBox>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Construction Notes Tab -->
            <TabItem Header="Construction Notes" Style="{StaticResource DarkTabItemStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        
                        <!-- NTXX File Location -->
                        <GroupBox Header="NTXX File Location" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Specify the location of the NTXX.dwg file for construction note block insertion:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="NTXX Block File:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="NoteBlockFilePathTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseNoteBlockButton" Content="Browse..." Width="80" Height="25" Style="{StaticResource DarkButtonStyle}" Click="BrowseNoteBlockButton_Click"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Targeted Construction Note Multileaders" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                
                                <TextBlock Text="Multileader styles that will be processed for construction notes:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                
                                <!-- Configured Styles List -->
                                <Border BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="1" CornerRadius="3" Background="{StaticResource DarkSurfaceBrush}">
                                    <StackPanel Margin="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="Configured Styles:" Style="{StaticResource DarkTextBlockStyle}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <Button Grid.Column="1" Name="EditStylesButton" Content="Edit Styles..." Width="100" Height="25" Style="{StaticResource DarkButtonStyle}" Click="EditStylesButton_Click"/>
                                        </Grid>
                                        <TextBlock Name="StylesDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" MinHeight="80" Margin="0,10,0,0" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Targeted Construction Note Blocks" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                
                                <TextBlock Text="Block references that will be processed for construction notes:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                
                                <!-- Configured Blocks List -->
                                <Border BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="1" CornerRadius="3" Background="{StaticResource DarkSurfaceBrush}">
                                    <StackPanel Margin="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="Configured Blocks:" Style="{StaticResource DarkTextBlockStyle}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <Button Grid.Column="1" Name="EditBlocksButton" Content="Edit Blocks..." Width="100" Height="25" Style="{StaticResource DarkButtonStyle}" Click="EditBlocksButton_Click"/>
                                        </Grid>
                                        <TextBlock Name="BlocksDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" MinHeight="80" Margin="0,10,0,0" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Construction Note Blocks" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Configuration and naming conventions for construction note blocks:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="160"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Block Naming Pattern:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="NT01, NT02, NT03, ..., NT24" FontWeight="SemiBold"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Max Notes Per Sheet:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Name="MaxNotesDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="24" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Number Attribute:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Name="NumberAttributeDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Number" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Note Attribute:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Name="NoteAttributeDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Note" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Visibility Property:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="4" Grid.Column="1" Name="VisibilityPropertyDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Visibility" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                </Grid>
                                
                            </StackPanel>
                        </GroupBox>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Title Blocks Tab -->
            <TabItem Header="Title Blocks" Style="{StaticResource DarkTabItemStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        
                        <!-- Title Block Attributes File Location -->
                        <GroupBox Header="Title Block Attributes File Location" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Specify the location of the title block DWG file for insertion:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Title Block File:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="TitleBlockFilePathTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseTitleBlockButton" Content="Browse..." Width="80" Height="25" Style="{StaticResource DarkButtonStyle}" Click="BrowseTitleBlockButton_Click"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Plotting Tab -->
            <TabItem Header="Plotting" Style="{StaticResource DarkTabItemStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        
                        <!-- Plotting Settings -->
                        <GroupBox Header="Plotting Settings" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                
                                <!-- Enable Plotting -->
                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Enable Plotting:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <CheckBox Grid.Column="1" Name="EnablePlottingCheckBox" 
                                              Content="Allow plotting operations" 
                                              Style="{StaticResource DarkCheckBoxStyle}" 
                                              VerticalAlignment="Center"/>
                                </Grid>
                                
                                <!-- Output Directory -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Output Directory:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="PlotOutputDirectoryTextBox" 
                                             Style="{StaticResource DarkTextBoxStyle}" 
                                             Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseOutputDirectoryButton" 
                                            Content="Browse..." 
                                            Width="80" 
                                            Height="25" 
                                            Style="{StaticResource DarkButtonStyle}" 
                                            Click="BrowseOutputDirectoryButton_Click"/>
                                </Grid>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Plot Format Settings -->
                        <GroupBox Header="Plot Format Settings" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Default plot format and settings for PDF output:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Default Format:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Row="0" Grid.Column="1" Name="DefaultPlotFormatComboBox">
                                        <ComboBoxItem Content="PDF" IsSelected="True"/>
                                    </ComboBox>
                                </Grid>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Plot Behavior -->
                        <GroupBox Header="Plot Behavior" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Plotting system behavior and file naming:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="160"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="File Naming:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="{}{SheetName}.pdf" FontWeight="SemiBold"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Plot Area:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Layout (Paper Space)" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Plot Settings Source:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Layout's Default Page Setup" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="File Overwrite:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Yes (Existing PDFs will be replaced)" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                </Grid>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Information -->
                        <GroupBox Header="How Plotting Works" Style="{StaticResource DarkGroupBoxStyle}">
                            <StackPanel Margin="10">
                                <TextBlock Style="{StaticResource DarkTextBlockStyle}" TextWrapping="Wrap" Margin="0,0,0,10">
                                    <Run Text="The plotting system uses AutoCAD's native plotting engine to create PDF files from selected sheets." FontWeight="SemiBold"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource DarkTextBlockStyle}" TextWrapping="Wrap" Margin="0,0,0,5">
                                    <Run Text="• " FontWeight="Bold"/><Run Text="Plots use each layout's existing page setup and plot device settings"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource DarkTextBlockStyle}" TextWrapping="Wrap" Margin="0,0,0,5">
                                    <Run Text="• " FontWeight="Bold"/><Run Text="Drawing files can be active, inactive, or closed - all scenarios are supported"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource DarkTextBlockStyle}" TextWrapping="Wrap" Margin="0,0,0,5">
                                    <Run Text="• " FontWeight="Bold"/><Run Text="Construction notes and title blocks can be updated before plotting"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource DarkTextBlockStyle}" TextWrapping="Wrap" Margin="0,0,0,5">
                                    <Run Text="• " FontWeight="Bold"/><Run Text="Failed plots are logged and reported in the job summary"/>
                                </TextBlock>
                                <TextBlock Style="{StaticResource DarkTextBlockStyle}" TextWrapping="Wrap" Margin="0,0,0,0">
                                    <Run Text="• " FontWeight="Bold"/><Run Text="Output files are named using the sheet name (e.g., ABC-101.pdf)"/>
                                </TextBlock>
                            </StackPanel>
                        </GroupBox>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
        </TabControl>
        
        <!-- Dialog Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right">
            <Button Name="SaveButton" 
                    Content="Save" 
                    Width="80" 
                    Height="30"
                    Style="{StaticResource DarkButtonStyle}"
                    Click="SaveButton_Click"
                    IsDefault="True"
                    Margin="0,0,10,0"/>
            <Button Name="CancelButton" 
                    Content="Cancel" 
                    Width="80" 
                    Height="30"
                    Style="{StaticResource DarkButtonStyle}"
                    Click="CancelButton_Click"
                    IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
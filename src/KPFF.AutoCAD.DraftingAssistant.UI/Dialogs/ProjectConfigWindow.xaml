<Window x:Class="KPFF.AutoCAD.DraftingAssistant.UI.Dialogs.ProjectConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Project Configuration Editor"
        Height="700"
        Width="800"
        WindowStartupLocation="CenterOwner"
        Background="#2E3440">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Themes/DarkTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   Text="Project Configuration Editor" 
                   Style="{StaticResource DarkTextBlockStyle}"
                   FontSize="16" 
                   FontWeight="Bold" 
                   Margin="0,0,0,20"/>
        
        <!-- Tab Control -->
        <TabControl Grid.Row="1" Background="{StaticResource DarkBackgroundBrush}" Margin="0,0,0,20">
            
            <!-- General Tab -->
            <TabItem Header="General" Style="{StaticResource DarkTabItemStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        
                        <!-- Project Information -->
                        <GroupBox Header="Project Information" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Project Name:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" Name="ProjectNameTextBox" Style="{StaticResource DarkTextBoxStyle}"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Client Name:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBox Grid.Row="1" Grid.Column="1" Name="ClientNameTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,10,0,0"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- File Paths -->
                        <GroupBox Header="File Paths" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                
                                <!-- Excel Index File -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Excel Index File:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="ExcelFilePathTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseExcelButton" Content="Browse..." Width="80" Height="25" Style="{StaticResource DarkButtonStyle}" Click="BrowseExcelButton_Click"/>
                                </Grid>
                                
                                <!-- DWG Files Path -->
                                <Grid Margin="0,10,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="DWG Files Path:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="DwgFilePathTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseDwgButton" Content="Browse..." Width="80" Height="25" Style="{StaticResource DarkButtonStyle}" Click="BrowseDwgButton_Click"/>
                                </Grid>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Excel Index Tables -->
                        <GroupBox Header="Excel Index Tables" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="The system expects the following tables in the Excel index file:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Sheet Index:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Name="SheetIndexTableTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="SHEET_INDEX"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Excel Notes:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,5,0,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Name="ExcelNotesTableTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="EXCEL_NOTES" Margin="0,5,0,0"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Notes Pattern:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,5,0,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Name="NotesPatternTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="ABC_NOTES, AB_NOTES, A_NOTES" Margin="0,5,0,0"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Sheet Naming -->
                        <GroupBox Header="Supported Sheet Naming Patterns" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="The following sheet naming patterns are supported:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                <TextBlock Name="SheetNamingPatternsTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" FontSize="11" 
                                          Text="• ABC-123, ABC-12, ABC-1&#x0a;• AB-123, AB-12, AB-1&#x0a;• A-123, A-12, A-1&#x0a;• ABC123, ABC12, ABC1&#x0a;• AB123, AB12, AB1&#x0a;• A123, A12, A1"/>
                            </StackPanel>
                        </GroupBox>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Construction Notes Tab -->
            <TabItem Header="Construction Notes" Style="{StaticResource DarkTabItemStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        
                        <!-- NTXX File Location -->
                        <GroupBox Header="NTXX File Location" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Specify the location of the NTXX.dwg file for construction note block insertion:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="NTXX Block File:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="NoteBlockFilePathTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseNoteBlockButton" Content="Browse..." Width="80" Height="25" Style="{StaticResource DarkButtonStyle}" Click="BrowseNoteBlockButton_Click"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Targeted Construction Note Multileaders" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                
                                <TextBlock Text="Multileader styles that will be processed for construction notes:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                
                                <!-- Configured Styles List -->
                                <Border BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="1" CornerRadius="3" Background="{StaticResource DarkSurfaceBrush}">
                                    <StackPanel Margin="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="Configured Styles:" Style="{StaticResource DarkTextBlockStyle}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <Button Grid.Column="1" Name="EditStylesButton" Content="Edit Styles..." Width="100" Height="25" Style="{StaticResource DarkButtonStyle}" Click="EditStylesButton_Click"/>
                                        </Grid>
                                        <TextBlock Name="StylesDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" MinHeight="80" Margin="0,10,0,0" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Targeted Construction Note Blocks" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                
                                <TextBlock Text="Block references that will be processed for construction notes:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                
                                <!-- Configured Blocks List -->
                                <Border BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="1" CornerRadius="3" Background="{StaticResource DarkSurfaceBrush}">
                                    <StackPanel Margin="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="Configured Blocks:" Style="{StaticResource DarkTextBlockStyle}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            <Button Grid.Column="1" Name="EditBlocksButton" Content="Edit Blocks..." Width="100" Height="25" Style="{StaticResource DarkButtonStyle}" Click="EditBlocksButton_Click"/>
                                        </Grid>
                                        <TextBlock Name="BlocksDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" MinHeight="80" Margin="0,10,0,0" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                                
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Construction Note Blocks" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Configuration and naming conventions for construction note blocks:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="160"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Block Naming Pattern:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="NT01, NT02, NT03, ..., NT24" FontWeight="SemiBold"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Max Notes Per Sheet:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Name="MaxNotesDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="24" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Number Attribute:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Name="NumberAttributeDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Number" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Note Attribute:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Name="NoteAttributeDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Note" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Visibility Property:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="4" Grid.Column="1" Name="VisibilityPropertyDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Visibility" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                </Grid>
                                
                            </StackPanel>
                        </GroupBox>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Title Blocks Tab -->
            <TabItem Header="Title Blocks" Style="{StaticResource DarkTabItemStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <StackPanel>
                        
                        <!-- Title Block Attributes File Location -->
                        <GroupBox Header="Title Block Attributes File Location" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Specify the location of the title block DWG file for insertion:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Title Block File:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="1" Name="TitleBlockFilePathTextBox" Style="{StaticResource DarkTextBoxStyle}" Margin="0,0,10,0"/>
                                    <Button Grid.Column="2" Name="BrowseTitleBlockButton" Content="Browse..." Width="80" Height="25" Style="{StaticResource DarkButtonStyle}" Click="BrowseTitleBlockButton_Click"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Title Block Configuration -->
                        <GroupBox Header="Title Block Configuration" Style="{StaticResource DarkGroupBoxStyle}" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock Text="Configuration settings for title block processing:" Style="{StaticResource DarkTextBlockStyle}" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="160"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Block Name Pattern:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Name="TitleBlockPatternDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="TB_ATT" FontWeight="SemiBold"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Max Attributes:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Name="MaxTitleBlockAttributesDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="50" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Visibility Property:" Style="{StaticResource DarkTextBlockStyle}" VerticalAlignment="Center" Margin="0,10,0,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Name="TitleBlockVisibilityDisplayTextBlock" Style="{StaticResource DarkTextBlockStyle}" FontFamily="Consolas" Text="Visibility" FontWeight="SemiBold" Margin="0,10,0,0"/>
                                </Grid>
                                
                            </StackPanel>
                        </GroupBox>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
        </TabControl>
        
        <!-- Dialog Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right">
            <Button Name="SaveButton" 
                    Content="Save" 
                    Width="80" 
                    Height="30"
                    Style="{StaticResource DarkButtonStyle}"
                    Click="SaveButton_Click"
                    IsDefault="True"
                    Margin="0,0,10,0"/>
            <Button Name="CancelButton" 
                    Content="Cancel" 
                    Width="80" 
                    Height="30"
                    Style="{StaticResource DarkButtonStyle}"
                    Click="CancelButton_Click"
                    IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>